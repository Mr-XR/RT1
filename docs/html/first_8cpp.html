<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>First node: src/assignment/src/first.cpp File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">First node
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="dir_7edcb19908b00c66cadae006df429a14.html">assignment</a></li><li class="navelem"><a class="el" href="dir_632d07e2bb99ef48038683008fcd7a28.html">src</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">first.cpp File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &quot;ros/ros.h&quot;</code><br />
<code>#include &quot;geometry_msgs/Twist.h&quot;</code><br />
<code>#include &quot;nav_msgs/Odometry.h&quot;</code><br />
<code>#include &quot;my_srv/Randpos.h&quot;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for first.cpp:</div>
<div class="dyncontent">
<div class="center"><img src="first_8cpp__incl.png" border="0" usemap="#src_2assignment_2src_2first_8cpp" alt=""/></div>
<map name="src_2assignment_2src_2first_8cpp" id="src_2assignment_2src_2first_8cpp">
</map>
</div>
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:aab6e381bffc34921244a29ec0538ba64"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="first_8cpp.html#aab6e381bffc34921244a29ec0538ba64">positionCallback</a> (const nav_msgs::Odometry::ConstPtr &amp;msg)</td></tr>
<tr class="separator:aab6e381bffc34921244a29ec0538ba64"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3c04138a5bfe5d72780bb7e82a18e627"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="first_8cpp.html#a3c04138a5bfe5d72780bb7e82a18e627">main</a> (int argc, char **argv)</td></tr>
<tr class="separator:a3c04138a5bfe5d72780bb7e82a18e627"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:ac050ecd28d14458e8d356e5f6d38a25b"><td class="memItemLeft" align="right" valign="top">ros::Publisher&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="first_8cpp.html#ac050ecd28d14458e8d356e5f6d38a25b">chatter_pub</a></td></tr>
<tr class="separator:ac050ecd28d14458e8d356e5f6d38a25b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a17bcd065930a8a7f9f194078d9977268"><td class="memItemLeft" align="right" valign="top">ros::ServiceClient&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="first_8cpp.html#a17bcd065930a8a7f9f194078d9977268">client</a></td></tr>
<tr class="separator:a17bcd065930a8a7f9f194078d9977268"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a71b52081906c5c95f08fe23019c5dd56"><td class="memItemLeft" align="right" valign="top">my_srv::Randpos&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="first_8cpp.html#a71b52081906c5c95f08fe23019c5dd56">rec_randpos</a></td></tr>
<tr class="separator:a71b52081906c5c95f08fe23019c5dd56"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4b312b3530217eb51cbad6e930610f6b"><td class="memItemLeft" align="right" valign="top">float&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="first_8cpp.html#a4b312b3530217eb51cbad6e930610f6b">vel_x</a></td></tr>
<tr class="separator:a4b312b3530217eb51cbad6e930610f6b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1dd0876197a1e2dba35d41d6a6d9eab4"><td class="memItemLeft" align="right" valign="top">float&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="first_8cpp.html#a1dd0876197a1e2dba35d41d6a6d9eab4">vel_y</a></td></tr>
<tr class="separator:a1dd0876197a1e2dba35d41d6a6d9eab4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9d466da6de3ce8a6002eeb6ac47204a6"><td class="memItemLeft" align="right" valign="top">float&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="first_8cpp.html#a9d466da6de3ce8a6002eeb6ac47204a6">randpos_x</a></td></tr>
<tr class="separator:a9d466da6de3ce8a6002eeb6ac47204a6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aad13f1b6016597150e885f101c9ff9f6"><td class="memItemLeft" align="right" valign="top">float&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="first_8cpp.html#aad13f1b6016597150e885f101c9ff9f6">randpos_y</a></td></tr>
<tr class="separator:aad13f1b6016597150e885f101c9ff9f6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af111fcabf9f8b38b69faa049d84be60d"><td class="memItemLeft" align="right" valign="top">geometry_msgs::Twist&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="first_8cpp.html#af111fcabf9f8b38b69faa049d84be60d">msg_sent</a></td></tr>
<tr class="separator:af111fcabf9f8b38b69faa049d84be60d"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="a3c04138a5bfe5d72780bb7e82a18e627"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int main </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>argc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char **&#160;</td>
          <td class="paramname"><em>argv</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>The ros::init() function needs to see argc and argv so that it can perform any ROS arguments and name remapping that were provided at the command line.</p>
<p>NodeHandle is the main access point to communications with the ROS system.</p>
<p>Here the client is created over getting a random position over the /randpos service</p>
<p>Here it is signaled that the program will publish the velocity on the topic /cmd_vel</p>
<p>In order to get a first random position and start moving the robot, before the subscribe is made, the random position is requested once. It is the same logic as explained in the end of the callback function</p>
<p>Here you are declaring the subscription to the topic /odom and calling the callback</p>
<p>ros::spin() will enter a loop, pumping callbacks. </p>

</div>
</div>
<a class="anchor" id="aab6e381bffc34921244a29ec0538ba64"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void positionCallback </td>
          <td>(</td>
          <td class="paramtype">const nav_msgs::Odometry::ConstPtr &amp;&#160;</td>
          <td class="paramname"><em>msg</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Message type twist for the velocity </p>
<p>In this callback the actual position of the robot is updated with every loop. This position is compared with the target position and if the target hasnÂ´t been reached beyond the stablished boundaries, the velocity is set. Else, the robot is stopped by setting a velocity of 0 and a new target position is requested. With this, the loop is reestarted</p>
<p>Here the distance/ velocity of the robot is computed for every loop and then printed in the screen. As the specification of the constant k was let to the programmer, in order to do the coding easier it has been defined as 1, like that, both distance and velocity remain equal</p>
<p>In this section of the code, there are 2 kind of "ifs", the ones concerning the X coordinate and the ones regarding the Y coordinate. With this code, it is verified if the distance between the robot and the target coordinates are outside the boundaries or not, and depending on it the velocity is set with the given formula or is set to 0 respectively. Then the velocity is published for the robot to start moving</p>
<p>In this section of the code, it is verified if the target has been reached, and if so, a new random position is requested (called) sending the maximum and minimum boundaries for the random number, and receiving said number in the variables randpos_x and randpos_y </p>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a class="anchor" id="ac050ecd28d14458e8d356e5f6d38a25b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">ros::Publisher chatter_pub</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>This program receives a random position and controlls the velocity of the robot to reach said target </p>

</div>
</div>
<a class="anchor" id="a17bcd065930a8a7f9f194078d9977268"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">ros::ServiceClient client</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Publisher for the velocity of the robot </p>

</div>
</div>
<a class="anchor" id="af111fcabf9f8b38b69faa049d84be60d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">geometry_msgs::Twist msg_sent</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>due to the election of K=1 as velocity constant, vel_x and vel_y are both the velocity of the robot and the distance with the target; while randpos_x and _randpos_y are the target random positions </p>

</div>
</div>
<a class="anchor" id="a9d466da6de3ce8a6002eeb6ac47204a6"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">float randpos_x</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="aad13f1b6016597150e885f101c9ff9f6"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">float randpos_y</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="a71b52081906c5c95f08fe23019c5dd56"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">my_srv::Randpos rec_randpos</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Client for receiving the random targer </p>

</div>
</div>
<a class="anchor" id="a4b312b3530217eb51cbad6e930610f6b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">float vel_x</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Message type received from the server </p>

</div>
</div>
<a class="anchor" id="a1dd0876197a1e2dba35d41d6a6d9eab4"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">float vel_y</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.11
</small></address>
</body>
</html>
